#!/usr/bin/env bash
# SPDX-License-Identifier: MPL-2.0
set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
# shellcheck source=common.sh
source "${SCRIPT_DIR}/common.sh"

if [[ ! -d "${VENV_DIR}" ]]; then
    python3 -m venv "${VENV_DIR}"
fi

# shellcheck disable=SC1091
source "${VENV_DIR}/bin/activate"

pip install --upgrade pip
pip install -e ".[dev]"

if command -v pre-commit >/dev/null 2>&1; then
    pre-commit install --install-hooks --hook-type pre-commit --hook-type pre-push
fi

echo "Bootstrap complete. Activate the environment with 'source .venv/bin/activate'."

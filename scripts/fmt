#!/usr/bin/env bash
set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
# shellcheck source=common.sh
source "${SCRIPT_DIR}/common.sh"

activate_venv

CHECK_ONLY=0
PATHS=()
for arg in "$@"; do
    if [[ "$arg" == "--check" ]]; then
        CHECK_ONLY=1
    else
        PATHS+=("$arg")
    fi
done

if [[ ${#PATHS[@]} -eq 0 ]]; then
    PATHS=("src" "tests" "scripts" "docs")
fi

if [[ ${CHECK_ONLY} -eq 1 ]]; then
    black --check "${PATHS[@]}"
    isort --check-only "${PATHS[@]}"
    ruff format --check "${PATHS[@]}"
else
    black "${PATHS[@]}"
    isort "${PATHS[@]}"
    ruff format "${PATHS[@]}"
fi
